# Epidemic control with noisy real-time data

Deciding when to enforce or relax non-pharmaceutical interventions (NPIs) is crucial in controlling the spread of infectious diseases. However, challenges arise from reporting delays and under-ascertainment of infections in real-time outbreak surveillance data, which can lead to mistimed NPIs and overload healthcare capacities during epidemic peaks. To address these challenges, we present a novel model-predictive control algorithm that optimises NPI decisions by minimising both their cumulative future risks and associated costs over stochastic epidemic projections.

Here we publish the code to carry out the calculations published in [PAPER link to come]

## Usage:
The codes can be run by installing [Epicont.jl](src/EpiCont.jl) as a Julia package.
This is done by pressing ] to access the package manager and entering `add https://github.com/sandorberegi/Epidemic-control-with-noisy-real-time-data`.

The package was generated by using PkgTemplates.jl.  For version compatibility, and dependency on other packages, please refer to [Project.toml](Project.toml) and [Manifest.toml](Manifest.toml).

The following files generate the results presented in the paper:

#### Epidemic simulations for a given set of parameters
**Figures 2 and 5:** [test/epicont.jl](test/epicont.jl)
**Figure 9:** [test/epicont_ur_betabin_R_uncertain.jl]([test/epicont_ur_betabin_R_uncertain.jl])

In each case you may toggle the appropriate lines to choose Epidemic parameters simulating COVID-19 or Ebola virus disease. E.g. for COVID-19

```
#Disease A (Covid-like)
R0 = 3.5 #Basic Reproduction number
gen_time = 6.5 #Generation time (in days)
gt_var = 2.1
δ = 0.08 #Death rate
I0 = 10 #initial no. of infections
ndays = 41*7 #epidemic length
ρ, ρvar = 0.25, 0.0 #Under reporting, mean/variance
repd_mean, del_disp = 10.5, 5.0 #Reporting delay, mean/variance

alpha = 1.3/Lc_target #~proportional gain (regulates error) covid
```

Select parameters setting what noise to consider. E.g. to include both under-reporting and delay:

```
# for delay and ur
use_inc = 1 #1: control for incidence, 0: control for infectiousness
delay_calc_v = 0 #1: as in ref, 0: from incidence
under_rep_calc = 3 #1: as in ref, 0: separately, from incidence, 2: same, but using a beta distribution for rho
distr_sel = 1 #0: Deterministic, 1: Poisson, 2: Binomial
delay_on = 1 #1: sim with time-delay, 0: no-delay (if 0, set delay_calc_v = 0)
under_rep_on = 1 #0: no under reporting, 1: calculate with under-reporting
```

#### Batch simulations and visualisation
To run the batch simulations to generate data for **Figures 3 and 7** showing the effect of time delay please use the following files:

| Method | Simulations | Plotting |
| -- | -- | -- |
| MPC | [test/epicont_for_batch_run.jl](test/epicont_for_batch_run.jl)|[test/plot_batch_del.jl](test/plot_batch_del.jl) and [test/plot_batch_del_ebola.jl](test/plot_batch_del_ebola.jl)|
| Event-triggered control| [test/epicont_for_batch_run_threshold.jl](test/epicont_for_batch_run_threshold.jl)|[test/plot_batch_del.jl](test/plot_batch_del.jl) and [test/plot_batch_del_ebola.jl](test/plot_batch_del_ebola.jl)|
| Time-triggered control| [test/epicont_for_batch_run_threshold_then_cyclic.jl](test/epicont_for_batch_run_threshold_then_cyclic.jl)|[test/plot_batch_del.jl](test/plot_batch_del.jl) and [test/plot_batch_del_ebola.jl](test/plot_batch_del_ebola.jl) |

To run the batch simulations to generate data for **Figures 4 and 8** showing the effect of under-reporting please use the following files:

| Method | Simulations | Plotting |
| -- | -- | -- |
| MPC | [test/epicont_for_batch_run_ur.jl](test/epicont_for_batch_run_ur.jl)|[test/plot_batch5_ur.jl](test/plot_batch5_ur.jl) and [test/plot_batch5_ebola_ur.jl](test/plot_batch5_ebola_ur.jl)|
| Event-triggered control| [test/epicont_for_batch_run_ur_threshold.jl](test/epicont_for_batch_run_ur_threshold.jl)| [test/plot_batch5_ur.jl](test/plot_batch5_ur.jl) and [test/plot_batch5_ebola_ur.jl](test/plot_batch5_ebola_ur.jl)|
| Time-triggered control| [test/epicont_for_batch_run_ur_threshold_then_cyclic.jl](test/epicont_for_batch_run_ur_threshold_then_cyclic.jl)|[test/plot_batch5_ur.jl](test/plot_batch5_ur.jl) and [test/plot_batch5_ebola_ur.jl](test/plot_batch5_ebola_ur.jl) |

## Contact:
For any queries regarding the code please contact me at s.beregi@imperial.ac.uk

## License:

This work is licensed under a Creative Commons Attribution 4.0 International License (CC-BY). You are free to share and adapt the material, but attribution is required. [Learn more](https://creativecommons.org/licenses/by/4.0/).
